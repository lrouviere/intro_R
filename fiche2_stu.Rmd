---
title: "Les objets R"
output: html_notebook
---

## Répertoire de travail

On commencera par créer un répertoire dans lequel on mettra tous les fichiers et projets de la formation. Pour chaque thème, on pourra créer un **nouveau projet** avec Rstudio dans lequel on placera ce fichier. Par défaut, le répertoire de travail se situera dans le répertoire de ce projet. On peut le vérifier avec la commande

```{r}
getwd()
```

La commande **setwd** permet de changer le répertoire de travail si besoin. On peut aussi le faire en utilisant le menu **Session -> Set Working directory -> Choose directory...**.

## Création d'objets

### Numérique

On crée un **objet R** en assignant une valeur (ou un caractère, vecteur...) avec les opérateurs **<-**, **->**, **=** 

```{r}
b<-41.3  # assigne la valeur 41.3 à l'objet b
x<-b     # b est assigné à x
x=b      # b est assigné à x
b->x     # b est assigné à x
is.numeric(b)
mode(b)
```

### Caractère

```{r}
x <- "La mort"
y <- "aux trousses"
paste(x,y)
is.character(x)
```

### Logique (Booléen)

```{r}
x <- TRUE
is.logical(x)
mode(x)
a <- 1
a==1
a!=1
a<0
a>0
```

### Vecteur

On peut définir un vecteur de plusieurs façons :

* fonction collect  **c**
```{r}
x <- c(1.2,5,9,11)
x
```

* opérateur séquence  **:**

```{r}
1:5
```

* fonction séquence **seq**

```{r}
seq(1,10,by=2)
seq(0,1,length=10)
```

* fonction **rep**

```{r}
rep(1,4)
rep(c(1,3),each=3)
```

On peut aussi créer des vecteurs  *caractère* ou *logique* 

```{r}
x <- c("A","B","C")
x <- rep("A",5)
paste("X",1:5,sep="-")
substr("statistician",5,9)
```


### Sélectionner une partie d'un vecteur

La sélection s'effectue à l'aide de crochets **[ ]**

```{r}
x <- c(-4,-3,1,3,5,8,0)
x[2]
x[c(2,5)]
x>0
x[x>0]
```


### Opérations

Expiquer les commandes suivantes

```{r}
x <- seq(-10,10,by=2)
y <- 1:length(x)
x+y
x*y
z <- x>0
x*z
```

## Facteurs

L'objet facteur est très utile pour travailler avec des variables qualitatives.

```{r}
V1 <- factor(c("less20years","more50years","less20years","more50years","less20years"))
V1
levels(V1)
levels(V1) <- c("Young","Old")
V1
```

### Exercice 1

1. Calculer la moyenne, la somme, la médiane et la variance du vecteur (1,3,8,9,11).


2. Créer les vecteurs suivants en utilisant la fonction **rep**.

vec1 = 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 

vec2 = 1 1 1 2 2 2 3 3 3 4 4 4 5 5 5

vec3 = 1 1 2 2 2 3 3 3 3 4 4 4 4 4


3. Créer le vecteur suivant à l'aide de la fonction **paste**.

vec4 = "A0)" "A1)" "A2)" "A3)" "A4)" "A5)" "A6)" "A7)" "A8)" "A9)" "A10)"



4. **letters** est un vecteur qui contient les 26 lettres de l'alphabet. 
    a) Trouver le numéro de la lettre $q$. On pourra utiliser la fonction **which**.
    b) Créer le vecteur "a1","b2",$\dots$ jusqu'à $q$ et son index.



## Matrices

La fonction **matrix** permet de définir des matrices.

```{r}
m <- matrix(1:4,ncol=2)
m
m <- matrix(1:4,nrow=2)
m
m <- matrix(1:4,nrow=2,byrow=TRUE)
dim(m)
```

La position d'un élement dans une matrice est indiquée par ses numéros de ligne et de colonne. Ainsi, pour séléctionner le terme de la 2ème ligne et la 1ère colonne, on utilisera

```{r}
m[2,1]
```

On peut aussi extraire des lignes et des colonnes :

```{r}
m[1,] #première ligne
m[,2] #deuxième colonne
```

Il n'est pas difficile de faire les calculs usuels sur les matrices :

```{r}
det(m) #déterminant
solve(m) #inverse
t(m) #transposé
n <- matrix(5:8,nrow=2)
m+n
m*n #attention : produit de Hadamart
m%*%n #Produit matriciel
eigen(m) #Décomposition en valeurs propres
```

## Listes

Une liste est un objet hétérogène. Elle permet de stocker des objets de différents modes dans un même objet. Par exemple, on peut céer une liste qui contient un vecteur et une matrice à l'aide de

```{r}
mylist <- list(vector=rep(1:5),mat=matrix(1:8,nrow=2))
mylist
length(mylist)
```

L'extraction s'effectue en indiquant la position de l'objet à extraire dans un **double crochet [[  ]]** :

```{r}
mylist[[1]]
```

On peut aussi utiliser le **nom** de l'élément à extraire :

```{r}
mylist$mat
mylist[["mat"]]
```


## Dataframe

Les dataframes sont des listes particulières dont les composantes ont la même longueur, mais potentiellement des modes différents. C'est l'objet généralement utilisé pour les **tableaux de données** (qui contiennent souvent des variables quantitatives et qualitatives). Par exemple,
```{r}
name <- c("Paul","Mary","Steven","Charlotte","Peter")
sex <- factor(c("M","F","M","F","M"))
size <- c(180,165,168,170,175)
data <- data.frame(name,sex,size)
summary(data)
```

On observe que *name* est un vecteur de caractère, *sex* un facteur et *size* un vecteur numérique.

L'extraction est similaire aux matrices et aux listes :

```{r}
data[2,3]
data[,2]
data$sex
```

## Quelqus fonctions importantes

* **summary** produit un résumé d'un objet

```{r}
summary(data)
summary(1:10)
```

* mean, sum, median, var, min, max... (facile à comprendre)

* *sort*, *order*

```{r}
x <- c(1,8,5,4)
sort(x)
order(x)
```

* **apply** applique une fonction **f** aux lignes ou colonnes d'une matrice ou dataframe

```{r}
V1 <- 1:10
V2 <- seq(-20,25,length=10)
df <- data.frame(V1,V2)
apply(df,1,mean)
apply(df,2,sum)
```

### Exercice 2

1. Créer la matrice suivante que l'on appellera *mat* (on pourra utiliser les fonctions **rownames** et **colnames**) :

|      |column 1 | column 2 |column 3 | column 4 |
|:----:|:-------:|:--------:|:-------:|:--------:|
|row-1 |    1    |     5    |    5    |    0     |
|row-2 |    0    |     5    |    6    |    1     |
|row-3 |    3    |     0    |    3    |    3     |
|row-4 |    4    |     4    |    4    |    2     |


2. Créer un vecteur qui contient la diagonal de **mat**.

3. Créer une matrice qui contient les 2 premières lignes de **mat**.

4. Créer une matrice qui contient les 2 dernières colonnes de **mat**.

5. Calculer le derterminant et l'inverse de **mat**.


### Exercice 3

On considère le jeu de données **iris** disponible sous **R** :

```{r}
data(iris)
head(iris)
```


1. Calculer les moyennes et variances des variables **Sepal.Width** et **Petal.Length**.


2. Créer un sous jeu de données qui contient uniquement les iris de l'espèce **versicolor**. On appellera ce tableau **iris2**.



3. Ordonner les individus dans  **iris2** par valeurs décroissantes de la variable  **Sepal.Length** (on pourra utiliser la fonction **order**).


4. Calculer les valeurs moyennes de **Sepal.Length** pour chaque espèce.


5. Ajouter une variable (qu'on appellera **sum.Petal**) dans le dataframe iris qui contiendra la somme de **Petal.Length** et **Petal.Width**.



### Exercice 4

1. Calculer les indicateurs numériques standards (moyenne, min, max, etc.) des 3 variables du jeux de données **ethanol** dataset (disponible dans le package *lattice*). 


2. Calculer les quartiles de chaque variables. On pourra faire un **apply** avec la fonction **quantile**.


3. Faire de même pour les déciles.


### Exercice 5

On considère le jeu de données **presidents**

```{r}
data("presidents")
df <- matrix(presidents,ncol=4,byrow=T)
```

1. Est-ce que la ligne 20 contient au moins une données manquante ? On pourra utiliser la fonction **any**.


2. Quelles sont les lignes de **df** qui contiennent au moins une donnée manquante ? On pourra utiliser la fonction **which**.

3. Supprimer les lignes de **df** qui contiennent au moins une donnée manquante.



